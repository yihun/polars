{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "f767e204",
   "metadata": {},
   "source": [
    "---\n",
    "title: \"Polars as dplyr Introdution\"\n",
    "format:\n",
    "  html:\n",
    "    embed-resources: true\n",
    "    mainfont: \"Roboto\"\n",
    "    code-overflow: scroll\n",
    "    code-line-numbers: true\n",
    "highlight-style: darkly\n",
    "css: styles.css\n",
    "date: '2026-02-13'\n",
    "---\n",
    "\n",
    "## Load polars ğŸ»â€â„ï¸\n",
    "- `uv pip install polars`\n",
    "- `uv pip install great_tables`\n",
    "- In this notebook a will try to attempt to use most used `dplyr` verbs that I have widely used in `r` Tidyverse Ecosystem."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e44d2374",
   "metadata": {},
   "outputs": [],
   "source": [
    "import polars as pl"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0c04b9a3",
   "metadata": {},
   "source": [
    "## dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "create-dataset",
   "metadata": {},
   "outputs": [],
   "source": [
    "#| label: create dataset\n",
    "\n",
    "df1 = pl.DataFrame(\n",
    "    {\n",
    "        \"id\": [1, 2, 3, 4, 5, 6],\n",
    "        \"group\": [\"A\", \"A\", \"B\", \"B\", \"C\", \"C\"],\n",
    "        \"age\": [25, 30, 22, 40, 35, 28],\n",
    "        \"income\": [50000, 60000, 45000, 80000, 72000, 52000],\n",
    "        \"status\": [\"active\", \"inactive\", \"active\", \"active\", \"inactive\", \"active\"],\n",
    "        \"prefix_score1\": [10, 20, 30, 40, 50, 60],\n",
    "        \"prefix_score2\": [5, 15, 25, 35, 45, 55],\n",
    "    }\n",
    ")\n",
    "\n",
    "df2 = pl.DataFrame({\"id\": [1, 2, 3, 7], \"city\": [\"NY\", \"LA\", \"Dallas\", \"Houston\"]})"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4f9967fd",
   "metadata": {},
   "source": [
    "**column names as a the dataframe.**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "1faf63f5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (7, 1)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>Name of the dataframe</th></tr><tr><td>str</td></tr></thead><tbody><tr><td>&quot;id&quot;</td></tr><tr><td>&quot;group&quot;</td></tr><tr><td>&quot;age&quot;</td></tr><tr><td>&quot;income&quot;</td></tr><tr><td>&quot;status&quot;</td></tr><tr><td>&quot;prefix_score1&quot;</td></tr><tr><td>&quot;prefix_score2&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (7, 1)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ Name of the dataframe â”‚\n",
       "â”‚ ---                   â”‚\n",
       "â”‚ str                   â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ id                    â”‚\n",
       "â”‚ group                 â”‚\n",
       "â”‚ age                   â”‚\n",
       "â”‚ income                â”‚\n",
       "â”‚ status                â”‚\n",
       "â”‚ prefix_score1         â”‚\n",
       "â”‚ prefix_score2         â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pl.DataFrame({\"Name of the dataframe\": list(df1.columns)})"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4e9994f2",
   "metadata": {},
   "source": [
    "## `.select()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "02dc0733",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>age</th><th>income</th></tr><tr><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>25</td><td>50000</td></tr><tr><td>2</td><td>30</td><td>60000</td></tr><tr><td>3</td><td>22</td><td>45000</td></tr><tr><td>4</td><td>40</td><td>80000</td></tr><tr><td>5</td><td>35</td><td>72000</td></tr><tr><td>6</td><td>28</td><td>52000</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 3)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† age â”† income â”‚\n",
       "â”‚ --- â”† --- â”† ---    â”‚\n",
       "â”‚ i64 â”† i64 â”† i64    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† 25  â”† 50000  â”‚\n",
       "â”‚ 2   â”† 30  â”† 60000  â”‚\n",
       "â”‚ 3   â”† 22  â”† 45000  â”‚\n",
       "â”‚ 4   â”† 40  â”† 80000  â”‚\n",
       "â”‚ 5   â”† 35  â”† 72000  â”‚\n",
       "â”‚ 6   â”† 28  â”† 52000  â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.select([\"id\", \"age\", \"income\"]).head(10)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "eac5b100",
   "metadata": {},
   "source": [
    "## `.filter()` "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "68fd7d56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (2, 7)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (2, 7)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† active   â”† 40            â”† 35            â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† inactive â”† 50            â”† 45            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.filter(pl.col(\"age\") > 30)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3a3b6174",
   "metadata": {},
   "source": [
    "### `.filter()` with *`chain`* method"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4a18710a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (2, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (2, 4)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(\n",
    "    df1\n",
    "    .filter(pl.col(\"age\")> 30)\n",
    "    .select([\"id\", \"group\", \"age\", \"income\"])\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2e3c3712",
   "metadata": {},
   "source": [
    "## `.with_columns()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1750afd3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>income</th><th>income_k</th></tr><tr><td>i64</td><td>f64</td></tr></thead><tbody><tr><td>50000</td><td>50.0</td></tr><tr><td>60000</td><td>60.0</td></tr><tr><td>45000</td><td>45.0</td></tr><tr><td>80000</td><td>80.0</td></tr><tr><td>72000</td><td>72.0</td></tr><tr><td>52000</td><td>52.0</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ income â”† income_k â”‚\n",
       "â”‚ ---    â”† ---      â”‚\n",
       "â”‚ i64    â”† f64      â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 50000  â”† 50.0     â”‚\n",
       "â”‚ 60000  â”† 60.0     â”‚\n",
       "â”‚ 45000  â”† 45.0     â”‚\n",
       "â”‚ 80000  â”† 80.0     â”‚\n",
       "â”‚ 72000  â”† 72.0     â”‚\n",
       "â”‚ 52000  â”† 52.0     â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.with_columns(\n",
    "    (pl.col(\"income\")/1000).alias(\"income_k\")\n",
    ").select(['income', \"income_k\"])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "39e45975",
   "metadata": {},
   "source": [
    "__mutate with multiple columns__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "018adbc5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 7)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>50</td><td>100000</td><td>&quot;active&quot;</td><td>20</td><td>10</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>60</td><td>120000</td><td>&quot;inactive&quot;</td><td>40</td><td>30</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>44</td><td>90000</td><td>&quot;active&quot;</td><td>60</td><td>50</td></tr><tr><td>4</td><td>&quot;B&quot;</td><td>80</td><td>160000</td><td>&quot;active&quot;</td><td>80</td><td>70</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>70</td><td>144000</td><td>&quot;inactive&quot;</td><td>100</td><td>90</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>56</td><td>104000</td><td>&quot;active&quot;</td><td>120</td><td>110</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 7)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 50  â”† 100000 â”† active   â”† 20            â”† 10            â”‚\n",
       "â”‚ 2   â”† A     â”† 60  â”† 120000 â”† inactive â”† 40            â”† 30            â”‚\n",
       "â”‚ 3   â”† B     â”† 44  â”† 90000  â”† active   â”† 60            â”† 50            â”‚\n",
       "â”‚ 4   â”† B     â”† 80  â”† 160000 â”† active   â”† 80            â”† 70            â”‚\n",
       "â”‚ 5   â”† C     â”† 70  â”† 144000 â”† inactive â”† 100           â”† 90            â”‚\n",
       "â”‚ 6   â”† C     â”† 56  â”† 104000 â”† active   â”† 120           â”† 110           â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.with_columns(\n",
    "    pl.all().exclude(['status', 'group','id'])*2\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "b5c04370",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 11)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>age_prod2</th><th>income_prod2</th><th>prefix_score1_prod2</th><th>prefix_score2_prod2</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>50</td><td>100000</td><td>20</td><td>10</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>60</td><td>120000</td><td>40</td><td>30</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>44</td><td>90000</td><td>60</td><td>50</td></tr><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td><td>80</td><td>160000</td><td>80</td><td>70</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td><td>70</td><td>144000</td><td>100</td><td>90</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>28</td><td>52000</td><td>&quot;active&quot;</td><td>60</td><td>55</td><td>56</td><td>104000</td><td>120</td><td>110</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 11)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† â€¦ â”† age_prod2 â”† income_prod2 â”† prefix_score1_pro â”† prefix_score2_pr â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”†   â”† ---       â”† ---          â”† d2                â”† od2              â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”†   â”† i64       â”† i64          â”† ---               â”† ---              â”‚\n",
       "â”‚     â”†       â”†     â”†        â”†   â”†           â”†              â”† i64               â”† i64              â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† â€¦ â”† 50        â”† 100000       â”† 20                â”† 10               â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† â€¦ â”† 60        â”† 120000       â”† 40                â”† 30               â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† â€¦ â”† 44        â”† 90000        â”† 60                â”† 50               â”‚\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† â€¦ â”† 80        â”† 160000       â”† 80                â”† 70               â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† â€¦ â”† 70        â”† 144000       â”† 100               â”† 90               â”‚\n",
       "â”‚ 6   â”† C     â”† 28  â”† 52000  â”† â€¦ â”† 56        â”† 104000       â”† 120               â”† 110              â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.with_columns(\n",
    "    [\n",
    "        (pl.col(col) * 2).alias(f\"{col}_prod2\")\n",
    "        for col in df1.columns\n",
    "        if col not in [\"status\", \"group\", \"id\"]\n",
    "    ]\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "778a0246",
   "metadata": {},
   "source": [
    "## `sort()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "2dbb48f5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 7)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>28</td><td>52000</td><td>&quot;active&quot;</td><td>60</td><td>55</td></tr><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 7)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† active   â”† 40            â”† 35            â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† inactive â”† 50            â”† 45            â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”‚\n",
       "â”‚ 6   â”† C     â”† 28  â”† 52000  â”† active   â”† 60            â”† 55            â”‚\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.sort(\"income\", descending=True) "
   ]
  },
  {
   "cell_type": "markdown",
   "id": "13f5f873",
   "metadata": {},
   "source": [
    "## `.rename()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "22fe56e5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 4)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>age</th><th>group</th><th>annual_income</th></tr><tr><td>i64</td><td>i64</td><td>str</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>25</td><td>&quot;A&quot;</td><td>50000</td></tr><tr><td>2</td><td>30</td><td>&quot;A&quot;</td><td>60000</td></tr><tr><td>3</td><td>22</td><td>&quot;B&quot;</td><td>45000</td></tr><tr><td>4</td><td>40</td><td>&quot;B&quot;</td><td>80000</td></tr><tr><td>5</td><td>35</td><td>&quot;C&quot;</td><td>72000</td></tr><tr><td>6</td><td>28</td><td>&quot;C&quot;</td><td>52000</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 4)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† age â”† group â”† annual_income â”‚\n",
       "â”‚ --- â”† --- â”† ---   â”† ---           â”‚\n",
       "â”‚ i64 â”† i64 â”† str   â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† 25  â”† A     â”† 50000         â”‚\n",
       "â”‚ 2   â”† 30  â”† A     â”† 60000         â”‚\n",
       "â”‚ 3   â”† 22  â”† B     â”† 45000         â”‚\n",
       "â”‚ 4   â”† 40  â”† B     â”† 80000         â”‚\n",
       "â”‚ 5   â”† 35  â”† C     â”† 72000         â”‚\n",
       "â”‚ 6   â”† 28  â”† C     â”† 52000         â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.rename({\"income\": \"annual_income\"}).select(['id', 'age', 'group', 'annual_income'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8b372f87",
   "metadata": {},
   "source": [
    "## `.slice()`\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "414c67c8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 7)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 7)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.slice(0, 3)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "42b0bda1",
   "metadata": {},
   "source": [
    "## `.select()` with aggregation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "7836a865",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (1, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>avg_income</th><th>max_age</th></tr><tr><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>59833.0</td><td>40</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (1, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ avg_income â”† max_age â”‚\n",
       "â”‚ ---        â”† ---     â”‚\n",
       "â”‚ f64        â”† i64     â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 59833.0    â”† 40      â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.select(\n",
    "    pl.col(\"income\").mean().round().alias(\"avg_income\"),\n",
    "    pl.col(\"age\").max().alias(\"max_age\"),\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "47d99fa3",
   "metadata": {},
   "source": [
    "## `.group_by()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c6077de6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (2, 3)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>status</th><th>Average Income</th><th>Young_Gens</th></tr><tr><td>str</td><td>f64</td><td>i64</td></tr></thead><tbody><tr><td>&quot;active&quot;</td><td>56750.0</td><td>22</td></tr><tr><td>&quot;inactive&quot;</td><td>66000.0</td><td>30</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (2, 3)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ status   â”† Average Income â”† Young_Gens â”‚\n",
       "â”‚ ---      â”† ---            â”† ---        â”‚\n",
       "â”‚ str      â”† f64            â”† i64        â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ active   â”† 56750.0        â”† 22         â”‚\n",
       "â”‚ inactive â”† 66000.0        â”† 30         â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.group_by(\"status\").agg(\n",
    "    pl.col(\"income\").mean().round(decimals=2).alias(\"Average Income\"),\n",
    "    pl.col('age').min().alias(\"Young_Gens\")\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce465e39",
   "metadata": {},
   "source": [
    "## `.group_by().count()`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "c9db3401",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (2, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>status</th><th>len</th></tr><tr><td>str</td><td>u32</td></tr></thead><tbody><tr><td>&quot;active&quot;</td><td>4</td></tr><tr><td>&quot;inactive&quot;</td><td>2</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (2, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”\n",
       "â”‚ status   â”† len â”‚\n",
       "â”‚ ---      â”† --- â”‚\n",
       "â”‚ str      â”† u32 â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•¡\n",
       "â”‚ active   â”† 4   â”‚\n",
       "â”‚ inactive â”† 2   â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df1.group_by('status').len()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "067c44db",
   "metadata": {},
   "source": [
    "## Left join `how = 'left'`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "11d0de60",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>city</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>&quot;NY&quot;</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>&quot;LA&quot;</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>&quot;Dallas&quot;</td></tr><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td><td>null</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td><td>null</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>28</td><td>52000</td><td>&quot;active&quot;</td><td>60</td><td>55</td><td>null</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 8)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”† city   â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”† ---    â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”† str    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”† NY     â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”† LA     â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”† Dallas â”‚\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† active   â”† 40            â”† 35            â”† null   â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† inactive â”† 50            â”† 45            â”† null   â”‚\n",
       "â”‚ 6   â”† C     â”† 28  â”† 52000  â”† active   â”† 60            â”† 55            â”† null   â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_left = df1.join(df2, on = \"id\", how=\"left\")\n",
    "df_combined_left"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5df91fd",
   "metadata": {},
   "source": [
    "## Right join `how = 'right'`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "761a16e3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (4, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>id</th><th>city</th></tr><tr><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>1</td><td>&quot;NY&quot;</td></tr><tr><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>2</td><td>&quot;LA&quot;</td></tr><tr><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>3</td><td>&quot;Dallas&quot;</td></tr><tr><td>null</td><td>null</td><td>null</td><td>null</td><td>null</td><td>null</td><td>7</td><td>&quot;Houston&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (4, 8)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ group â”† age  â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”† id  â”† city    â”‚\n",
       "â”‚ ---   â”† ---  â”† ---    â”† ---      â”† ---           â”† ---           â”† --- â”† ---     â”‚\n",
       "â”‚ str   â”† i64  â”† i64    â”† str      â”† i64           â”† i64           â”† i64 â”† str     â”‚\n",
       "â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ A     â”† 25   â”† 50000  â”† active   â”† 10            â”† 5             â”† 1   â”† NY      â”‚\n",
       "â”‚ A     â”† 30   â”† 60000  â”† inactive â”† 20            â”† 15            â”† 2   â”† LA      â”‚\n",
       "â”‚ B     â”† 22   â”† 45000  â”† active   â”† 30            â”† 25            â”† 3   â”† Dallas  â”‚\n",
       "â”‚ null  â”† null â”† null   â”† null     â”† null          â”† null          â”† 7   â”† Houston â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_right = df1.join(df2, on=\"id\", how=\"right\")\n",
    "df_combined_right"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8f103552",
   "metadata": {},
   "source": [
    "## Inner join `how = \"inner\"`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "18b19a96",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>city</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>&quot;NY&quot;</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>&quot;LA&quot;</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>&quot;Dallas&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 8)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”† city   â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”† ---    â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”† str    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”† NY     â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”† LA     â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”† Dallas â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_inner = df1.join(df2, on=\"id\", how=\"inner\")\n",
    "df_combined_inner"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4ddbda20",
   "metadata": {},
   "source": [
    "## Outer join `how = \"inner\"`"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "4509a08e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>city</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>&quot;NY&quot;</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>&quot;LA&quot;</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>&quot;Dallas&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 8)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”† city   â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”† ---    â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”† str    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”† NY     â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”† LA     â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”† Dallas â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_inner = df1.join(df2, on=\"id\", how=\"inner\")\n",
    "df_combined_inner"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a330cab9",
   "metadata": {},
   "source": [
    "## Selectors\n",
    "### `pl.all()`, `pl.col()`\n",
    "\n",
    "- select by data type\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "179546f0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 5)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>age</th><th>income</th><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>i64</td><td>i64</td><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>1</td><td>25</td><td>50000</td><td>10</td><td>5</td></tr><tr><td>2</td><td>30</td><td>60000</td><td>20</td><td>15</td></tr><tr><td>3</td><td>22</td><td>45000</td><td>30</td><td>25</td></tr><tr><td>4</td><td>40</td><td>80000</td><td>40</td><td>35</td></tr><tr><td>5</td><td>35</td><td>72000</td><td>50</td><td>45</td></tr><tr><td>6</td><td>28</td><td>52000</td><td>60</td><td>55</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 5)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† age â”† income â”† prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ --- â”† --- â”† ---    â”† ---           â”† ---           â”‚\n",
       "â”‚ i64 â”† i64 â”† i64    â”† i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† 25  â”† 50000  â”† 10            â”† 5             â”‚\n",
       "â”‚ 2   â”† 30  â”† 60000  â”† 20            â”† 15            â”‚\n",
       "â”‚ 3   â”† 22  â”† 45000  â”† 30            â”† 25            â”‚\n",
       "â”‚ 4   â”† 40  â”† 80000  â”† 40            â”† 35            â”‚\n",
       "â”‚ 5   â”† 35  â”† 72000  â”† 50            â”† 45            â”‚\n",
       "â”‚ 6   â”† 28  â”† 52000  â”† 60            â”† 55            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_left.select(\n",
    "    pl.col(pl.Int64)\n",
    ")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "f56aeccc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 8)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>city</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>&quot;NY&quot;</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>&quot;LA&quot;</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>&quot;Dallas&quot;</td></tr><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td><td>null</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td><td>null</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>28</td><td>52000</td><td>&quot;active&quot;</td><td>60</td><td>55</td><td>null</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 8)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† status   â”† prefix_score1 â”† prefix_score2 â”† city   â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”† ---      â”† ---           â”† ---           â”† ---    â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”† str      â”† i64           â”† i64           â”† str    â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† active   â”† 10            â”† 5             â”† NY     â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† inactive â”† 20            â”† 15            â”† LA     â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† active   â”† 30            â”† 25            â”† Dallas â”‚\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† active   â”† 40            â”† 35            â”† null   â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† inactive â”† 50            â”† 45            â”† null   â”‚\n",
       "â”‚ 6   â”† C     â”† 28  â”† 52000  â”† active   â”† 60            â”† 55            â”† null   â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_left.select(pl.all().exclude([\"income_k\"]))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "85057082",
   "metadata": {},
   "source": [
    "## Chained conditional"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "86b94ea3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (6, 9)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>id</th><th>group</th><th>age</th><th>income</th><th>status</th><th>prefix_score1</th><th>prefix_score2</th><th>city</th><th>age_group</th></tr><tr><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>i64</td><td>i64</td><td>str</td><td>str</td></tr></thead><tbody><tr><td>1</td><td>&quot;A&quot;</td><td>25</td><td>50000</td><td>&quot;active&quot;</td><td>10</td><td>5</td><td>&quot;NY&quot;</td><td>&quot;young&quot;</td></tr><tr><td>2</td><td>&quot;A&quot;</td><td>30</td><td>60000</td><td>&quot;inactive&quot;</td><td>20</td><td>15</td><td>&quot;LA&quot;</td><td>&quot;Mid&quot;</td></tr><tr><td>3</td><td>&quot;B&quot;</td><td>22</td><td>45000</td><td>&quot;active&quot;</td><td>30</td><td>25</td><td>&quot;Dallas&quot;</td><td>&quot;young&quot;</td></tr><tr><td>4</td><td>&quot;B&quot;</td><td>40</td><td>80000</td><td>&quot;active&quot;</td><td>40</td><td>35</td><td>null</td><td>&quot;Senior&quot;</td></tr><tr><td>5</td><td>&quot;C&quot;</td><td>35</td><td>72000</td><td>&quot;inactive&quot;</td><td>50</td><td>45</td><td>null</td><td>&quot;Mid&quot;</td></tr><tr><td>6</td><td>&quot;C&quot;</td><td>28</td><td>52000</td><td>&quot;active&quot;</td><td>60</td><td>55</td><td>null</td><td>&quot;young&quot;</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (6, 9)\n",
       "â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ id  â”† group â”† age â”† income â”† â€¦ â”† prefix_score1 â”† prefix_score2 â”† city   â”† age_group â”‚\n",
       "â”‚ --- â”† ---   â”† --- â”† ---    â”†   â”† ---           â”† ---           â”† ---    â”† ---       â”‚\n",
       "â”‚ i64 â”† str   â”† i64 â”† i64    â”†   â”† i64           â”† i64           â”† str    â”† str       â”‚\n",
       "â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 1   â”† A     â”† 25  â”† 50000  â”† â€¦ â”† 10            â”† 5             â”† NY     â”† young     â”‚\n",
       "â”‚ 2   â”† A     â”† 30  â”† 60000  â”† â€¦ â”† 20            â”† 15            â”† LA     â”† Mid       â”‚\n",
       "â”‚ 3   â”† B     â”† 22  â”† 45000  â”† â€¦ â”† 30            â”† 25            â”† Dallas â”† young     â”‚\n",
       "â”‚ 4   â”† B     â”† 40  â”† 80000  â”† â€¦ â”† 40            â”† 35            â”† null   â”† Senior    â”‚\n",
       "â”‚ 5   â”† C     â”† 35  â”† 72000  â”† â€¦ â”† 50            â”† 45            â”† null   â”† Mid       â”‚\n",
       "â”‚ 6   â”† C     â”† 28  â”† 52000  â”† â€¦ â”† 60            â”† 55            â”† null   â”† young     â”‚\n",
       "â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_left.with_columns(\n",
    "    pl.when(pl.col(\"age\") < 30).then(pl.lit(\"young\"))\n",
    "    .when(pl.col('age') < 40)\n",
    "    .then(pl.lit(\"Mid\"))\n",
    "    .otherwise(pl.lit(\"Senior\"))\n",
    "    .alias(\"age_group\")\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8ff2e537",
   "metadata": {},
   "source": [
    "## Prefix selection"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "2267428a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>10</td><td>5</td></tr><tr><td>20</td><td>15</td></tr><tr><td>30</td><td>25</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ ---           â”† ---           â”‚\n",
       "â”‚ i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 10            â”† 5             â”‚\n",
       "â”‚ 20            â”† 15            â”‚\n",
       "â”‚ 30            â”† 25            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_inner.select(pl.col(\"^prefix.*$\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "40720137",
   "metadata": {},
   "source": [
    "## Regex in `pl.col()`\n",
    "- selecting the all columns containing _score_ in the dataframe"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "a1069aeb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>10</td><td>5</td></tr><tr><td>20</td><td>15</td></tr><tr><td>30</td><td>25</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ ---           â”† ---           â”‚\n",
       "â”‚ i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 10            â”† 5             â”‚\n",
       "â”‚ 20            â”† 15            â”‚\n",
       "â”‚ 30            â”† 25            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_combined_inner.select(pl.col(\"^.*score.*$\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "932a7cce",
   "metadata": {},
   "source": [
    "__using polars selector__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "25e8b795",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div><style>\n",
       ".dataframe > thead > tr,\n",
       ".dataframe > tbody > tr {\n",
       "  text-align: right;\n",
       "  white-space: pre-wrap;\n",
       "}\n",
       "</style>\n",
       "<small>shape: (3, 2)</small><table border=\"1\" class=\"dataframe\"><thead><tr><th>prefix_score1</th><th>prefix_score2</th></tr><tr><td>i64</td><td>i64</td></tr></thead><tbody><tr><td>10</td><td>5</td></tr><tr><td>20</td><td>15</td></tr><tr><td>30</td><td>25</td></tr></tbody></table></div>"
      ],
      "text/plain": [
       "shape: (3, 2)\n",
       "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n",
       "â”‚ prefix_score1 â”† prefix_score2 â”‚\n",
       "â”‚ ---           â”† ---           â”‚\n",
       "â”‚ i64           â”† i64           â”‚\n",
       "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¡\n",
       "â”‚ 10            â”† 5             â”‚\n",
       "â”‚ 20            â”† 15            â”‚\n",
       "â”‚ 30            â”† 25            â”‚\n",
       "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import polars.selectors as cs\n",
    "\n",
    "df_combined_inner.select(cs.matches(\"score\"))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3",
   "path": "/Users/yanzel/Documents/PyProject/polars/.venv/share/jupyter/kernels/python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
